From b7b59d78b5a011fbae05786decbdd5a710ca9dba Mon Sep 17 00:00:00 2001
From: Bastien Nocera <hadess@hadess.net>
Date: Mon, 4 Dec 2017 14:30:01 +0100
Subject: [PATCH 08/12] dateMenu: Ignore malformed world-clocks settings

Guard against a malformed setting that doesn't contain a
'location' key.

https://bugzilla.gnome.org/show_bug.cgi?id=791148
---
 js/ui/dateMenu.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/js/ui/dateMenu.js b/js/ui/dateMenu.js
index 1d48fa8bd..5908c904f 100644
--- a/js/ui/dateMenu.js
+++ b/js/ui/dateMenu.js
@@ -132,6 +132,8 @@ var WorldClocksSection = new Lang.Class({
         let world = GWeather.Location.get_world();
         let clocks = settings.get_value('world-clocks').deep_unpack();
         for (let i = 0; i < clocks.length; i++) {
+            if (!clocks[i].location)
+                continue;
             let l = world.deserialize(clocks[i].location);
             this._locations.push({ location: l });
         }
-- 
2.15.1

